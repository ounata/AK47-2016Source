!function(){"use strict";mcs.ng=mcs.ng||angular.module("mcs.ng",["mcs.ng.datatable","mcs.ng.paging","mcs.ng.treeControl"]),mcs.ng.constant("mcsComponentConfig",{rootUrl:mcs.app.config.componentBaseUrl})}(),function(){"use strict";mcs.ng.filter("props",function(){return function(a,b){var c=[];if(angular.isArray(a)){var d=Object.keys(b);a.forEach(function(a){for(var e=!1,f=0;f<d.length;f++){var g=d[f],h=b[g].toLowerCase();if(-1!==a[g].toString().toLowerCase().indexOf(h)){e=!0;break}}e&&c.push(a)})}else c=a;return c}})}(),function(){"use strict";mcs.ng.constant("buttonConfig",{types:["add","edit","delete","search","save","cancel"],defaultTexts:["新 增","编 辑","删 除","查 询","保 存","取 消"],sizes:["mini","medium","large"],sizeCss:["btn-xs","btn-sm","btn-lg"],iconClass:["fa-plus","fa-pencil","fa-trash-o","fa-search","fa-save","fa-undo"]}).directive("mcsButton",function(a){return{restrict:"E",scope:{type:"@",disable:"=",text:"@",icon:"@",size:"@",css:"@",click:"&"},template:'<button class="btn mcs-width-130" ng-click="click()" ng-disabled="disable"><i class="ace-icon fa"></i><span></span></button>',replace:!0,transclude:!0,link:function(b,c,d,e){var f=a.types.indexOf(b.type),g="btn-info";switch(b.type){case"search":g="btn-primary";break;case"delete":g="btn-danger";break;case"save":g="btn-success";break;case"cancel":g="btn-light"}if(c.addClass(g),b.size){var h=a.sizes.indexOf(b.size);c.addClass(a.sizeCss[h])}b.icon&&-1===f?0==b.icon.indexOf("fa-")?c.find("i").addClass(b.icon):c.find("i").addClass("fa-"+b.icon):c.find("i").addClass(a.iconClass[f]),b.css&&c.addClass(b.css),c.find("span").text(b.text||a.defaultTexts[f])}}})}(),function(){mcs.ng.directive("mcsLinkList",function(a){return{restrict:"A",scope:{data:"=",click:"&"},template:'<button type="button" class="btn btn-link" data-toggle="button"  ng-repeat="item in data" ng-click="click({eventArgs:$event})">{{item.id}}</button>',link:function(a,b,c,d){}}}).directive("mcsCascadingSelect",function(a){return{restrict:"E",scope:{division:"=data",ngModel:"=",required:"@"},templateUrl:mcs.app.config.componentBaseUrl+"/src/tpl/mcs-cascading-select.tpl.html ",replace:!0,link:function(a,b,c){}}})}(),function(){"use strict";mcs.ng.directive("mcsCheckboxGroup",function(){return{restrict:"E",scope:{data:"=",model:"="},template:'<label class="checkbox-inline" ng-repeat="item in data"><input type="checkbox" class="ace" ng-checked="model && model.indexOf(item.key)!=-1" ng-click="change(item, $event)"><span class="lbl"></span> {{item.value}}</label>',controller:function(a){a.change=function(b,c){mcs.util.setSelectedItems(a.model,b,c)}}}})}(),function(){angular.module("mcs.ng.paging",[]).controller("pagingController",function(a){}).directive("tmPagination",function(){return{restrict:"EA",template:'<div class="page-list"><ul class="pagination" ng-show="conf.totalCount > 0"><li ng-class="{disabled: conf.pageIndex == 1}" ng-click="prevPage()"><span>&laquo;</span></li><li ng-repeat="item in pageList track by $index" ng-class="{active: item == conf.pageIndex, separate: item == \'...\'}" ng-click="changepageIndex(item)"><span>{{ item }}</span></li><li ng-class="{disabled: conf.pageIndex == conf.numberOfPages}" ng-click="nextPage()"><span>&raquo;</span></li></ul><div class="page-total" ng-show="conf.totalCount > 0">第<input type="text" ng-model="jumpPageNum"  ng-keypress="jumpToPage($event)"/>页 共<strong>{{ conf.totalCount }}</strong>条记录</div><div class="no-items" ng-show="conf.totalCount <= 0">暂无数据</div></div>',replace:!0,scope:{conf:"=",pageChange:"&"},link:function(a,b,c){function d(b,c){a.conf.pageIndex=parseInt(a.conf.pageIndex)?parseInt(a.conf.pageIndex):1,a.conf.totalCount=parseInt(a.conf.totalCount)?parseInt(a.conf.totalCount):0,a.conf.pageSize=parseInt(a.conf.pageSize)?parseInt(a.conf.pageSize):15,a.conf.numberOfPages=Math.ceil(a.conf.totalCount/a.conf.pageSize),a.conf.pageIndex<1&&(a.conf.pageIndex=1),a.conf.numberOfPages>0&&a.conf.pageIndex>a.conf.numberOfPages&&(a.conf.pageIndex=a.conf.numberOfPages),a.jumpPageNum=a.conf.pageIndex;for(var d,e=a.conf.perPageOptions.length,f=0;e>f;f++)a.conf.perPageOptions[f]==a.conf.pageSize&&(d=!0);if(d||a.conf.perPageOptions.push(a.conf.pageSize),a.conf.perPageOptions.sort(function(a,b){return a-b}),a.pageList=[],a.conf.numberOfPages<=a.conf.pagesLength)for(f=1;f<=a.conf.numberOfPages;f++)a.pageList.push(f);else{var g=(a.conf.pagesLength-1)/2;if(a.conf.pageIndex<=g){for(f=1;g+1>=f;f++)a.pageList.push(f);a.pageList.push("..."),a.pageList.push(a.conf.numberOfPages)}else if(a.conf.pageIndex>a.conf.numberOfPages-g){for(a.pageList.push(1),a.pageList.push("..."),f=g+1;f>=1;f--)a.pageList.push(a.conf.numberOfPages-f);a.pageList.push(a.conf.numberOfPages)}else{for(a.pageList.push(1),a.pageList.push("..."),f=Math.ceil(g/2);f>=1;f--)a.pageList.push(a.conf.pageIndex-f);for(a.pageList.push(a.conf.pageIndex),f=1;g/2>=f;f++)a.pageList.push(a.conf.pageIndex+f);a.pageList.push("..."),a.pageList.push(a.conf.numberOfPages)}}a.conf.onChange&&(c!=b&&0==c[0]||a.conf.onChange()),a.$parent.conf=a.conf}a.changepageIndex=function(b){"..."!=b&&(a.conf.pageIndex=b,a.pageChange())},a.conf.pagesLength=parseInt(a.conf.pagesLength)?parseInt(a.conf.pagesLength):9,a.conf.pagesLength%2===0&&(a.conf.pagesLength=a.conf.pagesLength-1),a.conf.perPageOptions||(a.conf.perPageOptions=[10,15,20,30,50]),a.prevPage=function(){a.conf.pageIndex>1&&(a.conf.pageIndex-=1,a.pageChange())},a.nextPage=function(){a.conf.pageIndex<a.conf.numberOfPages&&(a.conf.pageIndex+=1,a.pageChange())},a.jumpToPage=function(){a.jumpPageNum=a.jumpPageNum.replace(/[^0-9]/g,""),""!==a.jumpPageNum&&(a.conf.pageIndex=a.jumpPageNum,a.pageChange())},a.$watch(function(){a.conf.totalCount||(a.conf.totalCount=0);var b=a.conf.totalCount+" "+a.conf.pageIndex+" "+a.conf.pageSize;return b},d)}}})}(),function(){angular.module("mcs.ng.datatable",[]).controller("datatableController",function(a){a.paginationConf={currentPage:1,itemsPerPage:5,totalItems:20}}).directive("mcsDatatable",function(a){return{restrict:"E",templateUrl:mcs.app.config.componentBaseUrl+"/src/tpl/mcs-datatable.tpl.html ",replace:!0,scope:{data:"=",onOrder:"&?",pageChanged:"&"},link:function(a,b,c,d){a.selectAll=function(){a.data.selectAll?a.data.rows.forEach(function(a){a.selected=!0}):a.data.rows.forEach(function(a){a.selected=!1})},a.rowSelect=function(b){a.data.selectAll=!1,"radio"==a.data.selection&&(b.selected=!0,a.data.rows.forEach(function(c){b[a.data.keyField]!=c[a.data.keyField]&&(c.selected=!1)}))},a.reorder=function(b,c){b.orderDirection="asc"==b.orderDirection||void 0==b.orderDirection?"desc":"asc",b.sortable&&(a.onOrder&&angular.isFunction(a.onOrder())?a.onOrder({dataField:b.field,sortDirection:"asc"==b.orderDirection?0:1}):(a.data.orderBy[0].dataField=b.field,a.data.orderBy[0].sortDirection="asc"==b.orderDirection?0:1,c()))};var e=/click=['"]\w*/gi;a.data.headers.forEach(function(b,c){if(!b.field){var d=b.template.match(e);d&&d.forEach(function(b){var c=b.replace('"',"'").split("'")[1];a[c]=a.$parent[c]})}})}}}).directive("mcsDatatableRow",function(a){return{restrict:"A",link:function(b,c,d){var e=b.$parent.data.headers;b.row;e.forEach(function(d,e){var f=a("<td>"+(d.template||"<span>{{row."+d.field+"}}</span>")+"</td>")(b);c.append(f)})}}})}(),function(){"use strict";mcs.ng.service("mcsDialogService",["",function(){}])}(),function(){"use strict";mcs.ng.constant("inputConfig",{types:["text"]}).directive("mcsInput",["inputConfig","mcsComponentConfig",function(a,b){return{restrict:"E",replace:!0,scope:{id:"@",type:"@",placeholder:"@",fixed:"@",readonly:"@",css:"@",model:"="},template:'<input placeholder="{{placeholder}}" class="mcs-default-size-input mcs-margin-right-20 {{css}}" ng-model="model" />',link:function(a,b,c){a.id&&b.attr("id",a.id),b.attr("type",a.type||"text"),a.fixed&&b.addClass("fixed"),a.readonly&&b.attr("readonly","readonly")}}}])}(),function(){"use strict";mcs.ng.directive("mcsLabel",function(){return{restrict:"E",replace:!0,scope:{required:"@",text:"@",forInput:"@",css:"@"},template:'<label class="control-label no-padding-right {{css}}" for="{{forInput}}"> {{text}}</label>',link:function(a,b,c){a.required&&b.prepend('<span class="required">*</span>'),a.css&&b.addClass(a.css)}}})}(),function(){"use strict";mcs.ng.directive("mcsRadiobuttonGroup",function(){return{restrict:"E",scope:{data:"=",model:"="},template:'<label class="radio-inline" ng-repeat="item in data"><input name="{{groupName}}" type="radio" class="ace" ng-checked="model && item.key==model" ng-click="change(item)"><span class="lbl"></span> {{item.value}}</label>',controller:function(a){a.groupName=mcs.util.newGuid(),a.change=function(b){a.model=b.key}}}})}(),function(){"use strict";angular.module("mcs.ng.treeControl",[]).constant("treeConfig",{templateUrl:null}).directive("treecontrol",["$compile",function(a){function b(a,b){return a?b?'class="'+a+'"':a:""}function c(a,b,c){a.hasOwnProperty(b)||(a[b]=c)}return{restrict:"EA",require:"treecontrol",transclude:!0,scope:{treeModel:"=",selectedNode:"=?",selectedNodes:"=?",expandedNodes:"=?",onSelection:"&",onNodeToggle:"&",options:"=?",orderBy:"@",reverseOrder:"@",filterExpression:"=?",filterComparator:"=?"},controller:["$scope","$templateCache","$interpolate","treeConfig",function(d,e,f,g){function h(a){return!a[d.options.nodeChildren]||0===a[d.options.nodeChildren].length}function i(a,b){if(angular.isArray(a)){b=b||[];for(var c=0;c<a.length;c++)b[c]=a[c]}else if(angular.isObject(a)){b=b||{};for(var d in a)!hasOwnProperty.call(a,d)||"$"===d.charAt(0)&&"$"===d.charAt(1)||(b[d]=a[d])}return b||a}function j(a,b){return a&&b?(a=i(a),a[d.options.nodeChildren]=[],b=i(b),b[d.options.nodeChildren]=[],angular.equals(a,b)):!1}function k(){return!0}function l(a){if(!d.options.multiSelection&&d.options.equality(a,d.selectedNode))return!0;if(d.options.multiSelection&&d.selectedNodes){for(var b=0;b<d.selectedNodes.length;b++)if(d.options.equality(a,d.selectedNodes[b]))return!0;return!1}}d.options=d.options||{},c(d.options,"multiSelection",!1),c(d.options,"nodeChildren","children"),c(d.options,"dirSelectable","true"),c(d.options,"injectClasses",{}),c(d.options.injectClasses,"ul",""),c(d.options.injectClasses,"li",""),c(d.options.injectClasses,"liSelected",""),c(d.options.injectClasses,"iExpanded",""),c(d.options.injectClasses,"iCollapsed",""),c(d.options.injectClasses,"iLeaf",""),c(d.options.injectClasses,"label",""),c(d.options.injectClasses,"labelSelected",""),c(d.options,"equality",j),c(d.options,"isLeaf",h),c(d.options,"allowDeselect",!0),c(d.options,"isSelectable",k),d.selectedNodes=d.selectedNodes||[],d.expandedNodes=d.expandedNodes||[],d.expandedNodesMap={};for(var m=0;m<d.expandedNodes.length;m++)d.expandedNodesMap[""+m]=d.expandedNodes[m];d.parentScopeOfTree=d.$parent,d.headClass=function(a){var c=b(d.options.injectClasses.liSelected,!1),e="";return c&&l(a)&&(e=" "+c),d.options.isLeaf(a)?"tree-leaf"+e:d.expandedNodesMap[this.$id]?"tree-expanded"+e:"tree-collapsed"+e},d.iBranchClass=function(){return b(d.expandedNodesMap[this.$id]?d.options.injectClasses.iExpanded:d.options.injectClasses.iCollapsed)},d.nodeExpanded=function(){return!!d.expandedNodesMap[this.$id]},d.selectNodeHead=function(){var a=this,b=void 0===d.expandedNodesMap[a.$id];if(d.expandedNodesMap[a.$id]=b?a.node:void 0,b)d.expandedNodes.push(a.node);else{for(var c,e=0;e<d.expandedNodes.length&&!c;e++)d.options.equality(d.expandedNodes[e],a.node)&&(c=e);void 0!==c&&d.expandedNodes.splice(c,1)}if(d.onNodeToggle){var f=a.$parent.node===a.synteticRoot?null:a.$parent.node;d.onNodeToggle({node:a.node,$parentNode:f,$index:a.$index,$first:a.$first,$middle:a.$middle,$last:a.$last,$odd:a.$odd,$even:a.$even,expanded:b})}},d.selectNodeLabel=function(a){var b=this;if(d.options.isLeaf(a)||d.options.dirSelectable&&d.options.isSelectable(a)){if(d.options.isLeaf(a)&&!d.options.isSelectable(a))return;var c=!1;if(d.options.multiSelection){for(var e=-1,f=0;f<d.selectedNodes.length;f++)if(d.options.equality(a,d.selectedNodes[f])){e=f;break}-1===e?(d.selectedNodes.push(a),c=!0):d.selectedNodes.splice(e,1)}else d.options.equality(a,d.selectedNode)&&d.options.allowDeselect?d.selectedNode=void 0:(d.selectedNode=a,c=!0);if(d.onSelection){var g=b.$parent.node===b.synteticRoot?null:b.$parent.node;d.onSelection({node:a,selected:c,$parentNode:g,$index:b.$index,$first:b.$first,$middle:b.$middle,$last:b.$last,$odd:b.$odd,$even:b.$even})}}else this.selectNodeHead()},d.selectedClass=function(){var a=l(this.node),c=b(d.options.injectClasses.labelSelected,!1),e="";return c&&a&&(e=" "+c),a?"tree-selected"+e:""},d.unselectableClass=function(){var a=!d.options.isSelectable(this.node),c=b(d.options.injectClasses.labelUnselectable,!1);return a?"tree-unselectable "+c:""},d.isReverse=function(){return!("false"===d.reverseOrder||"False"===d.reverseOrder||""===d.reverseOrder||d.reverseOrder===!1)},d.orderByFunc=function(){return"'"+d.orderBy+"'"};var n,o={orderBy:d.orderBy?" | orderBy:orderByFunc():isReverse()":"",ulClass:b(d.options.injectClasses.ul,!0),nodeChildren:d.options.nodeChildren,liClass:b(d.options.injectClasses.li,!0),iLeafClass:b(d.options.injectClasses.iLeaf,!1),labelClass:b(d.options.injectClasses.label,!1)},p=d.options.templateUrl||g.templateUrl;p&&(n=e.get(p)),n||(n='<ul {{options.ulClass}} ><li ng-repeat="node in node.{{options.nodeChildren}} | filter:filterExpression:filterComparator {{options.orderBy}}" ng-class="headClass(node)" {{options.liClass}}set-node-to-data><i class="fa fa-folder" ng-class="iBranchClass()" ng-click="selectNodeHead(node)"></i><i class="tree-leaf-head {{options.iLeafClass}}"></i><div class="tree-label {{options.labelClass}}" ng-class="[selectedClass(), unselectableClass()]" ng-click="selectNodeLabel(node)" tree-transclude></div><treeitem ng-if="nodeExpanded()"></treeitem></li></ul>'),this.template=a(f(n)({options:o}))}],compile:function(a,b,c){return function(a,b,d,e){a.$watch("treeModel",function(b){if(angular.isArray(b)){if(angular.isDefined(a.node)&&angular.equals(a.node[a.options.nodeChildren],b))return;a.node={},a.synteticRoot=a.node,a.node[a.options.nodeChildren]=b}else{if(angular.equals(a.node,b))return;a.node=b}}),a.$watchCollection("expandedNodes",function(c,d){var e=0,f={},g=b.find("li"),h=[];angular.forEach(g,function(a){var b=angular.element(a),c={$id:b.data("scope-id"),node:b.data("node")};h.push(c)}),angular.forEach(c,function(b){for(var c=!1,d=0;d<h.length&&!c;d++){var g=h[d];a.options.equality(b,g.node)&&(f[g.$id]=g.node,c=!0)}c||(f[e++]=b)}),a.expandedNodesMap=f}),e.template(a,function(a){b.html("").append(a)}),a.$treeTransclude=c}}}}]).directive("setNodeToData",["$parse",function(a){return{restrict:"A",link:function(a,b,c){b.data("node",a.node),b.data("scope-id",a.$id)}}}]).directive("treeitem",function(){return{restrict:"E",require:"^treecontrol",link:function(a,b,c,d){d.template(a,function(a){b.html("").append(a)})}}}).directive("treeTransclude",function(){return{link:function(a,b,c,d){if(a.options.isLeaf(a.node)||angular.forEach(a.expandedNodesMap,function(b,c){a.options.equality(b,a.node)&&(a.expandedNodesMap[a.$id]=a.node,a.expandedNodesMap[c]=void 0)}),!a.options.multiSelection&&a.options.equality(a.node,a.selectedNode))a.selectedNode=a.node;else if(a.options.multiSelection){for(var e=[],f=0;f<a.selectedNodes.length;f++)a.options.equality(a.node,a.selectedNodes[f])&&e.push(a.node);a.selectedNodes=e}a.transcludeScope=a.parentScopeOfTree.$new(),a.transcludeScope.node=a.node,a.transcludeScope.$parentNode=a.$parent.node===a.synteticRoot?null:a.$parent.node,a.transcludeScope.$index=a.$index,a.transcludeScope.$first=a.$first,a.transcludeScope.$middle=a.$middle,a.transcludeScope.$last=a.$last,a.transcludeScope.$odd=a.$odd,a.transcludeScope.$even=a.$even,a.$on("$destroy",function(){a.transcludeScope.$destroy()}),a.$treeTransclude(a.transcludeScope,function(a){b.empty(),b.append(a)})}}})}(),function(){"use strict";mcs.ng.directive("phone",function(){return{restrict:"A",link:function(a,b,c){}}}).directive("email",function(){return{restrict:"A",link:function(a,b,c,d){}}}).directive("personCode",function(){return{restrict:"A",link:function(a,b,c){}}})}(),function(){"use strict";mcs.ng.service("validateService",function(){var a=this;a.ruleSet={phone:{required:!0,message:"phone number valid",patternDescription:"phone number should be 15 bit",pattern:function(a){return angular.isNumber(parseInt(a))&&15==a.length?!0:flase}}}}).service("validateMessageService",function(a){var b=this;b.processMessage=function(b,c){c?c.innerText=b.content:a.error(b.title,b.content)}})}();